(()=>{"use strict";class t{constructor(t,i,h){this.ctx=t,this.height=100,this.width=50,this.x=i,this.y=h,this.color="#ff0000"}init(){console.log("new sprite"),this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y,this.width,this.height)}update(){this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y-this.height,this.width,this.height)}}class i extends t{super(){this.color="#ff00ff"}}class h extends t{constructor(t,i,h){super(t,i,h),this.movingLeft=!1,this.movingRight=!1,this.jumping=!1,this.crouching=!1,this.xLeftVelocity=0,this.xRightVelocity=0,this.yUpVelocity=0,this.yDownVelocity=0,this.jumpTime=0,this.obstacles=[]}update(){this.y-=this.yUpVelocity,this.yUpVelocity>0&&this.yUpVelocity--,this.jumping&&this.yDownVelocity<=0?this.jump():this.fall(),this.movingLeft?(this.moveLeft(),this.xLeftVelocity<20&&this.xLeftVelocity++):this.xLeftVelocity>0&&(this.moveLeft(),this.xLeftVelocity--),this.movingRight?(this.moveRight(),this.xRightVelocity<20&&this.xRightVelocity++):this.xRightVelocity>0&&(this.moveRight(),this.xRightVelocity--),this.crouching?this.height=50:this.height=100,this.ctx.fillStyle=this.color,this.ctx.fillRect(this.x,this.y-this.height,this.width,this.height)}moveLeft(){for(let t of this.obstacles)t.x+t.width<this.x||t.y-t.height>this.y||this.x<t.x?this.x-=this.xLeftVelocity:(this.x=t.x+t.width,this.xLeftVelocity=0)}moveRight(){for(let t of this.obstacles)t.x-t.width>this.x+10||t.y-t.height>this.y||this.x>t.x?this.x+=this.xRightVelocity:(this.x=t.x-this.width-1,this.xRightVelocity=0)}jump(){this.jumping=!1,this.yUpVelocity=30}fall(){let t=[this.y>=this.ctx.canvas.attributes.height.textContent-1];for(let i of this.obstacles)t.push(this.y>=i.y-i.height-1&&this.x+this.width>=i.x&&this.x<i.x+i.width);t.some((t=>t))?(this.yDownVelocity>1&&(this.y-=this.yDownVelocity),this.yDownVelocity=0):(this.yDownVelocity<20&&(this.yDownVelocity+=1),this.y+=this.yDownVelocity)}}class e extends h{constructor(t,i,h){super(t,i,h),this.color="#ff00ff"}}window.onload=function(){var h={canvas:document.createElement("canvas"),start:function(){this.canvas.width=1e3,this.canvas.height=480,this.context=this.canvas.getContext("2d"),document.body.insertBefore(this.canvas,document.body.childNodes[0]),this.interval=setInterval(n,20)},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}};h.start();const s=new e(h.context,20,480),o=new t(h.context,500,480),c=new i(h.context,300,380);function n(){h.clear(),s.update(),o.update(),c.update(),s.obstacles=[o,c]}document.addEventListener("keydown",(function(t){"ArrowLeft"!=t.key||t.repeat||(s.movingLeft=!0),"ArrowRight"!=t.key||t.repeat||(s.movingRight=!0),"ArrowDown"!=t.key||t.repeat||(s.crouching=!0)," "!=t.key||t.repeat||(s.jumping=!0)})),document.addEventListener("keyup",(function(t){"ArrowLeft"==t.key&&(s.movingLeft=!1),"ArrowRight"==t.key&&(s.movingRight=!1),"ArrowDown"!=t.key||t.repeat||(s.crouching=!1)," "!=t.key||t.repeat||(s.jumping=!1)})),s.init(),o.init(),c.init()}})();